const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ScanTutorialFront-BdetEeA8.js","assets/carousel-3AxvjjqQ.js","assets/index-C2dvUutK.js","assets/index-C9VfYABH.css","assets/carousel-BUDl4TkN.css","assets/ScanTutorialFront-Cz2HVykd.css","assets/ScanTutorialSide-Bc0Vj5Sq.js","assets/ScanTutorialSide-DVHySAr2.css"])))=>i.map(i=>d[i]);
import{i,m as L,a6 as O,a7 as V,a as m,o as d,e as h,F as M,d as s,_ as A,c as U,p as S,r as x,f as u,w as p,g,t as R,a8 as q,a9 as K,b as z,aa as H,u as W,ab as G,ac as J,q as E}from"./index-C2dvUutK.js";const Q={style:{width:"100%",height:"500px",position:"relative"}},X={key:1,class:"underlayer",style:{position:"absolute",inset:"0","z-index":"2",display:"flex","flex-direction":"column","justify-content":"center","align-items":"center",background:"rgba(0,0,0,0.55)",color:"white","text-align":"center",padding:"20px",gap:"10px"}},Y={key:2},Z={__name:"CameraView",setup(N,{expose:C}){const t=i(null),f=i(null),r=i(!0),c=i(!1),n=i(!1);let l=null;L(async()=>{try{if(navigator.permissions&&(await navigator.permissions.query({name:"camera"})).state==="denied"){c.value=!0;return}l=O({constraints:{video:!0,audio:!1}}),await l.start(),f.value=l.stream.value,f.value&&t.value?(t.value.srcObject=f.value,await t.value.play(),n.value=!0):r.value=!1}catch(e){console.error("Camera error:",e),e.name==="NotAllowedError"||e.name==="PermissionDeniedError"?c.value=!0:r.value=!1}});const y=()=>{var e;try{l==null||l.stop(),(e=t.value)!=null&&e.srcObject&&(t.value.srcObject.getTracks().forEach(_=>_.stop()),t.value.srcObject=null)}catch(o){console.warn("Stop camera error",o)}f.value=null,n.value=!1},b=()=>{if(!t.value||!n.value)return null;const e=document.createElement("canvas");return e.width=t.value.videoWidth,e.height=t.value.videoHeight,e.getContext("2d").drawImage(t.value,0,0,e.width,e.height),e.toDataURL("image/png")};return V(()=>y()),C({video:t,cameraReady:n,hasCamera:r,permissionDenied:c,takeScreenshot:b,stopCamera:y}),(e,o)=>(d(),m("div",Q,[r.value&&!c.value?(d(),m("video",{key:0,ref_key:"video",ref:t,autoplay:"",playsinline:"",muted:"",style:{width:"100%",height:"100%","object-fit":"cover","z-index":"1"}},null,512)):h("",!0),!r.value||c.value||!n.value?(d(),m("div",X,[r.value?c.value?(d(),m(M,{key:1},[o[3]||(o[3]=s("span",{style:{color:"red","font-weight":"bold"}},"ðŸš« Camera permission denied.",-1)),s("button",{onClick:o[1]||(o[1]=_=>e.window.location.reload()),style:{padding:"10px 20px","font-size":"1.1em"}},"Retry")],64)):(d(),m("span",Y,"ðŸ“· Loading camera...")):(d(),m(M,{key:0},[o[2]||(o[2]=s("span",{style:{color:"red","font-weight":"bold"}},"âŒ No camera detected.",-1)),s("button",{onClick:o[0]||(o[0]=_=>e.window.location.reload()),style:{padding:"10px 20px","font-size":"1.1em"}},"Retry")],64))])):h("",!0)]))}},ee={class:"frontFace"},ae={class:"video-container"},te={class:"video-container__sizer"},ne={class:"inner"},oe={class:"tutorial"},se={class:"upload-button"},le={__name:"ScanFaceNonNative",props:["side"],emits:["picture-taken"],setup(N,{emit:C}){const t=S(()=>E(()=>import("./ScanTutorialFront-BdetEeA8.js"),__vite__mapDeps([0,1,2,3,4,5]))),f=S(()=>E(()=>import("./ScanTutorialSide-Bc0Vj5Sq.js"),__vite__mapDeps([6,1,2,3,4,7]))),r=N,c=U(()=>{switch(r.side){case"front":return t;default:return f}}),n=i(!1),l=i(),y=i(null),b=i(""),e=i(null);i(!1);const o=C,_=()=>{y.value.click()},F=T=>{const a=T.target.files[0];if(a){b.value=a.name;const k=new FileReader;k.onload=D=>{e.value=D.target.result,l.value.open(),console.log("Uploaded file:",b.value)},k.readAsDataURL(a)}},I=()=>{o("picture-taken",e.value),l.value.dismissDirect()},$=()=>{l.value.dismiss()},v=i(!1),j=()=>{v.value&&(e.value=v.value.takeScreenshot(),l.value.open())};return(T,a)=>{const k=x("MaxText"),D=x("ion-icon"),w=x("MaxButton"),B=x("MaxImage");return d(),m(M,null,[s("div",ee,[u(k,null,{default:p(()=>[g("Take a "+R(r.side)+" selfie",1)]),_:1}),s("div",ae,[s("div",te,[q(s("div",ne,[n.value?(d(),z(Z,{key:0,ref_key:"cameraRef",ref:v},null,512)):h("",!0)],512),[[K,n.value]]),s("div",oe,[n.value?h("",!0):(d(),z(H(c.value),{key:0,onPictureTaken:T.sidePictureTaken,onTutorialComplete:a[0]||(a[0]=P=>n.value=!0)},null,40,["onPictureTaken"]))])])]),a[4]||(a[4]=s("br",null,null,-1)),u(k,{class:"description"},{default:p(()=>[u(D,{"aria-hidden":"true",icon:W(G),class:"blub"},null,8,["icon"]),a[3]||(a[3]=g(" Make sure your face is well lit ",-1))]),_:1}),s("label",se,[u(w,{class:"large",disabled:!n.value,onClick:_,size:250},{default:p(()=>[g(R(n.value?"Upload from library":"Loading..."),1)]),_:1},8,["disabled"]),s("input",{type:"file",ref_key:"fileInput",ref:y,accept:"image/jpeg, image/png",onChange:F,style:{display:"none"}},null,544)]),u(w,{class:"large",disabled:!n.value||v.value.permissionDenied||!v.value.cameraReady,onClick:j,size:250},{default:p(()=>[g(R(n.value&&!v.value.permissionDenied&&v.value.cameraReady?"Take a selfie":"Loading..."),1)]),_:1},8,["disabled"])]),u(J,{ref_key:"modalPreview",ref:l,title:"Are you happy with the photo?"},{default:p(()=>[u(B,{img:e.value,borderRadius:25},null,8,["img"]),a[7]||(a[7]=s("br",null,null,-1)),u(w,{onClick:a[1]||(a[1]=P=>I()),size:250},{default:p(()=>[...a[5]||(a[5]=[g("Keep",-1)])]),_:1}),u(w,{onClick:a[2]||(a[2]=P=>$()),size:250},{default:p(()=>[...a[6]||(a[6]=[g("Try again",-1)])]),_:1})]),_:1},512)],64)}}},re=A(le,[["__scopeId","data-v-1ed1b975"]]);export{re as default};
