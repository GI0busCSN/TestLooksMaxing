import{u as X}from"./useIDBKeyval-D_wVPeQ7-mH-yy2GG.js";import{_ as Y,i as y,l as $,r as C,a as m,o as f,d as a,b as E,e as I,f as l,v as Z,w as s,g as c,t as p,F as S,k as j,X as Q,Y as W,Z as ee}from"./index-s2GOKCun.js";const te={class:"wrapper"},ae={class:"cards"},oe={class:"card front"},ne={class:"scan-container","aria-hidden":"false"},se={key:0,class:"scan-overlay","aria-hidden":"true"},re={class:"rating"},le={href:"TestLooksMaxing/"},ie={href:"TestLooksMaxing/"},G="https://text.pollinations.ai/openai",ce="83ea34a0ab0d41e5d26b68b74c392655",de="https://raw.githubusercontent.com/GI0busCSN/LooksMax-Articles/refs/heads/main/HumanValidationPromt.txt",ue="https://raw.githubusercontent.com/GI0busCSN/LooksMax-Articles/refs/heads/main/AnalyticsPromt.txt",fe={__name:"Results",props:["data"],setup(R){const w=R,i=y(),U="https://api.imgbb.com/1/upload?key=".concat(ce);async function N(t){const e=new FormData,o=t.replace(/^data:image\/(png|jpeg|jpg);base64,/,"");e.append("image",o);try{const n=await(await fetch(U,{method:"POST",body:e})).json();if(n.success&&n.data&&n.data.url)return n.data.url;throw h(),new Error("Image upload failed")}catch(d){throw h(),console.error("Image upload error:",d),d}}async function F(){try{return await(await fetch(de)).text()}catch(t){return console.log("getValidationPromt with an error",t),null}}async function H(){try{return await(await fetch(ue)).text()}catch(t){return console.log("getValidationPromt with an error",t),null}}const B=async(t,e,o)=>({model:"openai",messages:[{role:"system",content:await o()},{role:"user",content:JSON.stringify({frontPhoto:t,profilePhoto:e})}],temperature:1,stream:!1,reasoning_effort:"high"}),L=y(""),_=y("");async function J(){var t,e,o,d,n,g;i.value="Scanning";try{const[r,v]=await Promise.all([N(w.data.front),N(w.data.side)]);i.value="Validating";const u=await B(r,v,F);console.log("Sending validation request:",u);const T=await(await fetch(G,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)})).json(),b=(o=(e=(t=T==null?void 0:T.choices)==null?void 0:t[0])==null?void 0:e.message)==null?void 0:o.content;if(console.log("Validation response:",b),!b||b.toLowerCase().includes("error")){const x=await JSON.parse(b);_.value=x[0].Error.PhotoError.reason,console.log("Validation failed or returned error"),i.value="ValidationError",h();return}i.value="Fetching";const D=await B(r,v,H);console.log("Sending max request:",D);const P=await(await fetch(G,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)})).json(),V=(g=(n=(d=P==null?void 0:P.choices)==null?void 0:d[0])==null?void 0:n.message)==null?void 0:g.content;if(console.log("MaxPrompt response:",V),V){i.value="Done";const x=await JSON.parse(V);L.value=x,z(x,w.data.front,w.data.side)}else console.log("No content returned from MaxPrompt"),h(),i.value="Error"}catch(r){i.value="Error",h(),console.error("Request error:",r)}}const{data:M,set:q}=X("res",[]);async function z(t,e,o){var r,v,u;await W();const d=Array.isArray(M==null?void 0:M.value)?ee(M.value):[],n={id:Date.now(),res:(r=t.value)!=null?r:t,firstP:(v=e.value)!=null?v:e,secondP:(u=o.value)!=null?u:o},g=[...d,n];await q(g),console.log("✅ Saved successfully:",g)}$(()=>{J()});const O=y(null),h=()=>{var t;(t=O.value)==null||t.open()},A=y(null),K=()=>{var t;(t=A.value)==null||t.open()};return(t,e)=>{const o=C("MaxText"),d=C("MaxImage"),n=C("MaxButton"),g=C("MaxModal");return f(),m(S,null,[a("div",te,[e[3]||(e[3]=Z('<div class="faceIdAnim-figma" id="faceIdIcon" data-v-2bc2ece1><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-2bc2ece1><defs data-v-2bc2ece1><filter id="neon-glow" x="-50%" y="-50%" width="200%" height="200%" data-v-2bc2ece1><feGaussianBlur in="SourceGraphic" stdDeviation="1.5" result="blur" data-v-2bc2ece1></feGaussianBlur><feMerge data-v-2bc2ece1><feMergeNode in="blur" data-v-2bc2ece1></feMergeNode><feMergeNode in="SourceGraphic" data-v-2bc2ece1></feMergeNode></feMerge></filter></defs><g filter="url(#neon-glow)" stroke="#00e08f" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-2bc2ece1><path class="corner corner-tl" d="M8 3H7.8C6.11984 3 5.27976 3 4.63803 3.32698C4.07354 3.6146 3.6146 4.07354 3.32698 4.63803C3 5.27976 3 6.11984 3 7.8V8" data-v-2bc2ece1></path><path class="corner corner-bl" d="M8 21H7.8C6.11984 21 5.27976 21 4.63803 20.673C4.07354 20.3854 3.6146 19.9265 3.32698 19.362C3 18.7202 3 17.8802 3 16.2V16" data-v-2bc2ece1></path><path class="corner corner-tr" d="M21 8V7.8C21 6.11984 21 5.27976 20.673 4.63803C20.3854 4.07354 19.9265 3.6146 19.362 3.32698C18.7202 3 17.8802 3 16.2 3H16" data-v-2bc2ece1></path><path class="corner corner-br" d="M21 16V16.2C21 17.8802 21 18.7202 20.673 19.362C20.3854 19.9265 19.9265 20.3854 19.362 20.673C18.7202 21 17.8802 21 16.2 21H16" data-v-2bc2ece1></path><path class="face-eye eye-left" d="M7.5 8V9.5" data-v-2bc2ece1></path><path class="face-eye eye-right" d="M16.5 8V9.5" data-v-2bc2ece1></path><path class="face-nose" d="M11 12.6001C11.8 12.6001 12.5 11.9001 12.5 11.1001V8" data-v-2bc2ece1></path><path class="face-mouth" d="M15.2002 15.2C13.4002 17 10.5002 17 8.7002 15.2" data-v-2bc2ece1></path></g></svg></div>',1)),l(o,{class:"large center"},{default:s(()=>[c(p(i.value)+" your face...",1)]),_:1}),!i.value=="Done"?(f(),E(o,{key:0,class:"description center"},{default:s(()=>[...e[1]||(e[1]=[c("This should only take a minute",-1)])]),_:1})):I("",!0),a("div",ae,[a("div",oe,[a("div",ne,[l(d,{img:R.data.front,borderRadius:25},null,8,["img"]),!i.value=="Done"?(f(),m("div",se,[...e[2]||(e[2]=[a("div",{class:"scan-line",role:"presentation"},null,-1),a("div",{class:"scan-grid",role:"presentation"},null,-1),a("div",{class:"scan-glow",role:"presentation"},null,-1)])])):I("",!0)])])])]),e[11]||(e[11]=a("br",null,null,-1)),i.value=="Done"?(f(),E(n,{key:0,size:250,onClick:e[0]||(e[0]=r=>K())},{default:s(()=>[...e[4]||(e[4]=[c("See results",-1)])]),_:1})):I("",!0),l(g,{ref_key:"resultModal",ref:A},{default:s(()=>[a("ul",null,[(f(!0),m(S,null,j(L.value,(r,v)=>(f(),m("section",{key:v},[(f(!0),m(S,null,j(r.features,(u,k)=>(f(),m("div",{class:"content",key:k},[a("section",null,[l(o,{class:"icon"},{default:s(()=>[c(p(u.emoji),1)]),_:2},1024),a("li",null,[a("strong",null,p(k),1),c(": "+p(u.trait),1)]),a("div",re,[l(o,null,{default:s(()=>[c("⭐ "+p(u.score),1)]),_:2},1024)])]),e[5]||(e[5]=a("div",{class:"divider-thick"},null,-1))]))),128)),e[6]||(e[6]=a("div",{class:"divider-thick"},null,-1)),l(o,null,{default:s(()=>[c("Average Score: "+p(r.averageScore),1)]),_:2},1024),l(o,null,{default:s(()=>[c("Training Type: "+p(r.typeOfTraining.TrainingId),1)]),_:2},1024)]))),128)),a("a",le,[l(n,null,{default:s(()=>[...e[7]||(e[7]=[c("Try again🔁",-1)])]),_:1})])])]),_:1},512),l(Q,{ref_key:"modalError",ref:O,title:"Failed Connection"},{default:s(()=>[l(o,{class:"large center"},{default:s(()=>[...e[8]||(e[8]=[c(" Connection to the server failed❌ ",-1)])]),_:1}),l(o,{class:"description center"},{default:s(()=>[c(p(_.value?_.value:"Please check your network connection and try again🛜"),1)]),_:1}),e[10]||(e[10]=a("br",null,null,-1)),a("a",ie,[l(n,{size:"250"},{default:s(()=>[...e[9]||(e[9]=[a("a",{href:"TestLooksMaxing/"},"Retry",-1)])]),_:1})])]),_:1},512)],64)}}},me=Y(fe,[["__scopeId","data-v-2bc2ece1"]]);export{me as default};
