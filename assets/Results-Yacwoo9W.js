import{u as F,R as z}from"./ResultsParser-BVUc4ten.js";import{_ as K,i as v,m as $,r as M,a as D,o as x,d as s,b as E,e as P,f as l,D as X,w as i,g as u,t as R,a3 as Y,F as Q,C as W,A as Z}from"./index-CYHeDW7z.js";const ee={class:"wrapper"},te={class:"cards"},ae={class:"card front"},oe={class:"scan-container","aria-hidden":"false"},se={key:0,class:"scan-overlay","aria-hidden":"true"},ne={href:"TestLooksMaxing/"},re={href:"TestLooksMaxing/"},L="https://text.pollinations.ai/openai",le="83ea34a0ab0d41e5d26b68b74c392655",ie="https://raw.githubusercontent.com/GI0busCSN/LooksMax-Articles/refs/heads/main/HumanValidationPromt.txt",ce="https://raw.githubusercontent.com/GI0busCSN/LooksMax-Articles/refs/heads/main/AnalyticsPromt.txt",de={__name:"Results",props:["data"],setup(V){const m=V,n=v(),O="https://api.imgbb.com/1/upload?key=".concat(le);async function I(t){const e=new FormData,a=t.replace(/^data:image\/(png|jpeg|jpg);base64,/,"");e.append("image",a);try{const o=await(await fetch(O,{method:"POST",body:e})).json();if(o.success&&o.data&&o.data.url)return o.data.url;throw f(),new Error("Image upload failed")}catch(r){throw f(),console.error("Image upload error:",r),r}}async function j(){try{return await(await fetch(ie)).text()}catch(t){return console.log("getValidationPromt with an error",t),null}}async function G(){try{return await(await fetch(ce)).text()}catch(t){return console.log("getValidationPromt with an error",t),null}}const N=async(t,e,a)=>({model:"openai",messages:[{role:"system",content:await a()},{role:"user",content:JSON.stringify({frontPhoto:t,profilePhoto:e})}],reasoning_effort:"high"}),S=v(""),b=v("");async function U(){var t,e,a,r,o,d;n.value="Scanning";try{const[c,p]=await Promise.all([I(m.data.front),I(m.data.side)]);n.value="Validating";const g=await N(c,p,j);console.log("Sending validation request:",g);const C=await(await fetch(L,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)})).json(),y=(a=(e=(t=C==null?void 0:C.choices)==null?void 0:t[0])==null?void 0:e.message)==null?void 0:a.content;if(console.log("Validation response:",y),!y||y.toLowerCase().includes("error")){const w=await JSON.parse(y);b.value=w[0].Error.PhotoError.reason,console.log("Validation failed or returned error"),n.value="ValidationError",f();return}n.value="Fetching";const A=await N(c,p,G);console.log("Sending max request:",A);const _=await(await fetch(L,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)})).json(),k=(d=(o=(r=_==null?void 0:_.choices)==null?void 0:r[0])==null?void 0:o.message)==null?void 0:d.content;if(console.log("MaxPrompt response:",k),k){n.value="Done";const w=await JSON.parse(k);S.value=w,J(w,m.data.front,m.data.side)}else console.log("No content returned from MaxPrompt"),f(),n.value="Error"}catch(c){n.value="Error",f(),console.error("Request error:",c)}}const{data:h,set:H}=F("res",[]);async function J(t,e,a){var c,p,g;await W();const r=Array.isArray(h==null?void 0:h.value)?Z(h.value):[],o={id:Date.now(),res:(c=t.value)!=null?c:t,firstP:(p=e.value)!=null?p:e,secondP:(g=a.value)!=null?g:a},d=[...r,o];await H(d),console.log("âœ… Saved successfully:",d)}$(()=>{U()});const T=v(null),f=()=>{var t;(t=T.value)==null||t.open()},B=v(null),q=()=>{var t;(t=B.value)==null||t.open()};return(t,e)=>{const a=M("MaxText"),r=M("MaxImage"),o=M("MaxButton"),d=M("MaxModal");return x(),D(Q,null,[s("div",ee,[e[3]||(e[3]=X('<div class="faceIdAnim-figma" id="faceIdIcon" data-v-2bf205b8><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-2bf205b8><defs data-v-2bf205b8><filter id="neon-glow" x="-50%" y="-50%" width="200%" height="200%" data-v-2bf205b8><feGaussianBlur in="SourceGraphic" stdDeviation="1.5" result="blur" data-v-2bf205b8></feGaussianBlur><feMerge data-v-2bf205b8><feMergeNode in="blur" data-v-2bf205b8></feMergeNode><feMergeNode in="SourceGraphic" data-v-2bf205b8></feMergeNode></feMerge></filter></defs><g filter="url(#neon-glow)" stroke="#00e08f" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-2bf205b8><path class="corner corner-tl" d="M8 3H7.8C6.11984 3 5.27976 3 4.63803 3.32698C4.07354 3.6146 3.6146 4.07354 3.32698 4.63803C3 5.27976 3 6.11984 3 7.8V8" data-v-2bf205b8></path><path class="corner corner-bl" d="M8 21H7.8C6.11984 21 5.27976 21 4.63803 20.673C4.07354 20.3854 3.6146 19.9265 3.32698 19.362C3 18.7202 3 17.8802 3 16.2V16" data-v-2bf205b8></path><path class="corner corner-tr" d="M21 8V7.8C21 6.11984 21 5.27976 20.673 4.63803C20.3854 4.07354 19.9265 3.6146 19.362 3.32698C18.7202 3 17.8802 3 16.2 3H16" data-v-2bf205b8></path><path class="corner corner-br" d="M21 16V16.2C21 17.8802 21 18.7202 20.673 19.362C20.3854 19.9265 19.9265 20.3854 19.362 20.673C18.7202 21 17.8802 21 16.2 21H16" data-v-2bf205b8></path><path class="face-eye eye-left" d="M7.5 8V9.5" data-v-2bf205b8></path><path class="face-eye eye-right" d="M16.5 8V9.5" data-v-2bf205b8></path><path class="face-nose" d="M11 12.6001C11.8 12.6001 12.5 11.9001 12.5 11.1001V8" data-v-2bf205b8></path><path class="face-mouth" d="M15.2002 15.2C13.4002 17 10.5002 17 8.7002 15.2" data-v-2bf205b8></path></g></svg></div>',1)),l(a,{class:"large center"},{default:i(()=>[u(R(n.value)+" your face...",1)]),_:1}),n.value!=="Done"?(x(),E(a,{key:0,class:"description center"},{default:i(()=>[...e[1]||(e[1]=[u("This should only take a minute",-1)])]),_:1})):P("",!0),s("div",te,[s("div",ae,[s("div",oe,[l(r,{img:V.data.front,borderRadius:25},null,8,["img"]),!n.value=="Done"?(x(),D("div",se,[...e[2]||(e[2]=[s("div",{class:"scan-line",role:"presentation"},null,-1),s("div",{class:"scan-grid",role:"presentation"},null,-1),s("div",{class:"scan-glow",role:"presentation"},null,-1)])])):P("",!0)])])])]),e[8]||(e[8]=s("br",null,null,-1)),n.value=="Done"?(x(),E(o,{key:0,size:250,onClick:e[0]||(e[0]=c=>q())},{default:i(()=>[...e[4]||(e[4]=[u("See results",-1)])]),_:1})):P("",!0),l(d,{ref_key:"resultModal",ref:B},{default:i(()=>[l(z,{results:S.value},null,8,["results"]),s("a",ne,[l(o,null,{default:i(()=>[...e[5]||(e[5]=[u("Try againðŸ”",-1)])]),_:1})])]),_:1},512),l(Y,{ref_key:"modalError",ref:T,title:"Error"},{default:i(()=>[l(a,{class:"large center"},{default:i(()=>[u(R(b.value?"ErrorâŒ":"Connection to the server failedâŒ"),1)]),_:1}),l(a,{class:"description center"},{default:i(()=>[u(R(b.value?b.value:"Please check your network connection and try againðŸ›œ"),1)]),_:1}),e[7]||(e[7]=s("br",null,null,-1)),s("a",re,[l(o,{size:"250"},{default:i(()=>[...e[6]||(e[6]=[s("a",{href:"TestLooksMaxing/"},"Retry",-1)])]),_:1})])]),_:1},512)],64)}}},ve=K(de,[["__scopeId","data-v-2bf205b8"]]);export{ve as default};
