System.register(["./index-legacy-C8oJnis8.js"],function(e,a){"use strict";var t,i,l,n,o,r,d,s,u,c,v,p,m,f,g,y,b,h,k,x,w,_,C,j,z;return{setters:[e=>{t=e.i,i=e.l,l=e.a5,n=e.a6,o=e.a,r=e.o,d=e.e,s=e.F,u=e.d,c=e._,v=e.c,p=e.m,m=e.r,f=e.f,g=e.w,y=e.g,b=e.t,h=e.a7,k=e.a8,x=e.b,w=e.a9,_=e.u,C=e.aa,j=e.ab,z=e.p}],execute:function(){var T=document.createElement("style");T.textContent='@charset "UTF-8";.video-container[data-v-1ed1b975]{display:flex;justify-content:center;align-items:center;width:100%}.video-container__sizer[data-v-1ed1b975]{width:500px;height:500px;border-radius:16px;overflow:hidden;background-color:#000;position:relative;object-fit:cover;aspect-ratio:1/1}.video-container__sizer video[data-v-1ed1b975]{z-index:1;width:100%;height:100%;object-fit:cover}.video-container__sizer .underlayer[data-v-1ed1b975]{position:absolute;top:0;right:0;bottom:0;left:0;z-index:2;display:flex;flex-direction:column;justify-content:center;align-items:center;background-color:rgba(0,0,0,.55);color:#fff;text-align:center;padding:20px;gap:10px;transition:opacity .3s ease}.frontFace[data-v-1ed1b975]{text-align:center}.blub[data-v-1ed1b975]{color:#ff0}.description.error[data-v-1ed1b975]{color:red;font-weight:700}.upload-button[data-v-1ed1b975]{display:inline-block;position:relative;margin-top:10px}\n',document.head.appendChild(T);const R={style:{width:"100%",height:"500px",position:"relative"}},S={key:1,class:"underlayer",style:{position:"absolute",inset:"0","z-index":"2",display:"flex","flex-direction":"column","justify-content":"center","align-items":"center",background:"rgba(0,0,0,0.55)",color:"white","text-align":"center",padding:"20px",gap:"10px"}},D={key:2},F={__name:"CameraView",setup(e,{expose:a}){const c=t(null),v=t(null),p=t(!0),m=t(!1),f=t(!1);let g=null;i(async()=>{try{if(navigator.permissions&&"denied"===(await navigator.permissions.query({name:"camera"})).state)return void(m.value=!0);g=l({constraints:{video:!0,audio:!1}}),await g.start(),v.value=g.stream.value,v.value&&c.value?(c.value.srcObject=v.value,await c.value.play(),f.value=!0):p.value=!1}catch(e){console.error("Camera error:",e),"NotAllowedError"===e.name||"PermissionDeniedError"===e.name?m.value=!0:p.value=!1}});const y=()=>{try{var e,a;null===(e=g)||void 0===e||e.stop(),null!==(a=c.value)&&void 0!==a&&a.srcObject&&(c.value.srcObject.getTracks().forEach(e=>e.stop()),c.value.srcObject=null)}catch(t){console.warn("Stop camera error",t)}v.value=null,f.value=!1};return n(()=>y()),a({video:c,cameraReady:f,hasCamera:p,permissionDenied:m,takeScreenshot:()=>{if(!c.value||!f.value)return null;const e=document.createElement("canvas");return e.width=c.value.videoWidth,e.height=c.value.videoHeight,e.getContext("2d").drawImage(c.value,0,0,e.width,e.height),e.toDataURL("image/png")},stopCamera:y}),(e,a)=>(r(),o("div",R,[p.value&&!m.value?(r(),o("video",{key:0,ref_key:"video",ref:c,autoplay:"",playsinline:"",muted:"",style:{width:"100%",height:"100%","object-fit":"cover","z-index":"1"}},null,512)):d("",!0),p.value&&!m.value&&f.value?d("",!0):(r(),o("div",S,[p.value?m.value?(r(),o(s,{key:1},[a[3]||(a[3]=u("span",{style:{color:"red","font-weight":"bold"}},"🚫 Camera permission denied.",-1)),u("button",{onClick:a[1]||(a[1]=a=>e.window.location.reload()),style:{padding:"10px 20px","font-size":"1.1em"}},"Retry")],64)):(r(),o("span",D,"📷 Loading camera...")):(r(),o(s,{key:0},[a[2]||(a[2]=u("span",{style:{color:"red","font-weight":"bold"}},"❌ No camera detected.",-1)),u("button",{onClick:a[0]||(a[0]=a=>e.window.location.reload()),style:{padding:"10px 20px","font-size":"1.1em"}},"Retry")],64))]))]))}},E={class:"frontFace"},L={class:"video-container"},P={class:"video-container__sizer"},U={class:"inner"},I={class:"tutorial"},M={class:"upload-button"};e("default",c({__name:"ScanFaceNonNative",props:["side"],emits:["picture-taken"],setup(e,{emit:i}){const l=p(()=>z(()=>a.import("./ScanTutorialFront-legacy-mJjz7UP6.js"),void 0)),n=p(()=>z(()=>a.import("./ScanTutorialSide-legacy-BvwyF5mp.js"),void 0)),c=e,T=v(()=>"front"===c.side?l:n),R=t(!1),S=t(),D=t(null),N=t(""),O=t(null);t(!1);const A=i,q=()=>{D.value.click()},B=e=>{const a=e.target.files[0];if(a){N.value=a.name;const e=new FileReader;e.onload=e=>{O.value=e.target.result,S.value.open(),console.log("Uploaded file:",N.value)},e.readAsDataURL(a)}},H=t(!1),K=()=>{H.value&&(O.value=H.value.takeScreenshot(),S.value.open())};return(e,a)=>{const t=m("MaxText"),i=m("ion-icon"),l=m("MaxButton"),n=m("MaxImage");return r(),o(s,null,[u("div",E,[f(t,null,{default:g(()=>[y("Take a "+b(c.side)+" selfie",1)]),_:1}),u("div",L,[u("div",P,[h(u("div",U,[R.value?(r(),x(F,{key:0,ref_key:"cameraRef",ref:H},null,512)):d("",!0)],512),[[k,R.value]]),u("div",I,[R.value?d("",!0):(r(),x(w(T.value),{key:0,onPictureTaken:e.sidePictureTaken,onTutorialComplete:a[0]||(a[0]=e=>R.value=!0)},null,40,["onPictureTaken"]))])])]),a[4]||(a[4]=u("br",null,null,-1)),f(t,{class:"description"},{default:g(()=>[f(i,{"aria-hidden":"true",icon:_(C),class:"blub"},null,8,["icon"]),a[3]||(a[3]=y(" Make sure your face is well lit ",-1))]),_:1}),u("label",M,[f(l,{class:"large",disabled:!R.value,onClick:q,size:250},{default:g(()=>[y(b(R.value?"Upload from library":"Loading..."),1)]),_:1},8,["disabled"]),u("input",{type:"file",ref_key:"fileInput",ref:D,accept:"image/jpeg, image/png",onChange:B,style:{display:"none"}},null,544)]),f(l,{class:"large",disabled:!R.value||H.value.permissionDenied||!H.value.cameraReady,onClick:K,size:250},{default:g(()=>[y(b(R.value&&!H.value.permissionDenied&&H.value.cameraReady?"Take a selfie":"Loading..."),1)]),_:1},8,["disabled"])]),f(j,{ref_key:"modalPreview",ref:S,title:"Are you happy with the photo?"},{default:g(()=>[f(n,{img:O.value,borderRadius:25},null,8,["img"]),a[7]||(a[7]=u("br",null,null,-1)),f(l,{onClick:a[1]||(a[1]=e=>(A("picture-taken",O.value),void S.value.dismissDirect())),size:250},{default:g(()=>[...a[5]||(a[5]=[y("Keep",-1)])]),_:1}),f(l,{onClick:a[2]||(a[2]=e=>{S.value.dismiss()}),size:250},{default:g(()=>[...a[6]||(a[6]=[y("Try again",-1)])]),_:1})]),_:1},512)],64)}}},[["__scopeId","data-v-1ed1b975"]]))}}});
